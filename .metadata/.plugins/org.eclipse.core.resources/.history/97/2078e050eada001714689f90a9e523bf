package com.cioclass.util.or;

import java.util.List;
import java.util.Set;
import java.util.UUID;

import com.google.common.collect.Lists;
import com.google.common.collect.Sets;

public class QrcodeBuilder {
	/**
	 * 创建二维码内容
	 * 
	 * @param en
	 *            enterprise code
	 * @param bn
	 *            batchInfo code
	 * @param url
	 *            URL地址前缀
	 * @param size
	 *            随机号码长度
	 * @param num
	 *            生成内容数量
	 */
	private List<String> createContent(String en, String bn, String url, int size, int num) {
		/**
		 * 设置后面的随机数
		 */
		Set<String> set = getSet(size, num);
		List<String> list = Lists.newArrayList();
		StringBuilder sb = new StringBuilder();
		int i = 1;
		for (String s : set) {
			sb = new StringBuilder();
			sb = sb.append(en).append(bn).append(" ").append(getNumStr(i, 6))
					.append(",").append(url).append("?n=").append(en).append(bn).append(s);
			list.add(sb.toString());
			i++;
		}
		return list;
	}
	
	private String getNumStr(int no,int size) {
		String ns = String.format("%0"+size+"d", no);
		return ns.substring(0, 3)+" "+ns.substring(3);
	}

	/**
	 * 获取字符串集合
	 * 
	 * @param size
	 *            随机号码长度
	 * @param num
	 *            生成内容数量
	 * @return
	 */
	private Set<String> getSet(int size, int num) {
		Set<String> set = Sets.newHashSet();
		int count = 0;
		while (count < num) {
			if (set.add(UUID.randomUUID().toString().replace("-", "").substring(0, size))) {
				count++;
			}
		}
		return set;
	}
}
